// Copyright Amazon.com Inc. or its affiliates. All Rights Reserved.
// SPDX-License-Identifier: Apache-2.0
import { _decryptStream } from './decrypt_stream';
import { _decrypt } from './decrypt';
import { CommitmentPolicy, SignaturePolicy, needs, } from '@aws-crypto/material-management-node';
export function buildDecrypt(options) {
    const { commitmentPolicy, maxEncryptedDataKeys = false } = typeof options === 'string' ? { commitmentPolicy: options } : options;
    /* Precondition: node buildDecrypt needs a valid commitmentPolicy. */
    needs(CommitmentPolicy[commitmentPolicy], 'Invalid commitment policy.');
    /* Precondition: node buildDecrypt needs a valid maxEncryptedDataKeys. */
    needs(maxEncryptedDataKeys === false || maxEncryptedDataKeys >= 1, 'Invalid maxEncryptedDataKeys value.');
    const clientOptions = {
        commitmentPolicy,
        maxEncryptedDataKeys,
    };
    return {
        decryptUnsignedMessageStream: _decryptStream.bind({}, {
            signaturePolicy: SignaturePolicy.ALLOW_ENCRYPT_FORBID_DECRYPT,
            clientOptions,
        }),
        decryptStream: _decryptStream.bind({}, {
            signaturePolicy: SignaturePolicy.ALLOW_ENCRYPT_ALLOW_DECRYPT,
            clientOptions,
        }),
        decrypt: _decrypt.bind({}, {
            signaturePolicy: SignaturePolicy.ALLOW_ENCRYPT_ALLOW_DECRYPT,
            clientOptions,
        }),
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGVjcnlwdF9jbGllbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvZGVjcnlwdF9jbGllbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsb0VBQW9FO0FBQ3BFLHNDQUFzQztBQUV0QyxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sa0JBQWtCLENBQUE7QUFDakQsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLFdBQVcsQ0FBQTtBQUNwQyxPQUFPLEVBQ0wsZ0JBQWdCLEVBQ2hCLGVBQWUsRUFFZixLQUFLLEdBQ04sTUFBTSxzQ0FBc0MsQ0FBQTtBQVM3QyxNQUFNLFVBQVUsWUFBWSxDQUMxQixPQUF5QztJQVV6QyxNQUFNLEVBQUUsZ0JBQWdCLEVBQUUsb0JBQW9CLEdBQUcsS0FBSyxFQUFFLEdBQ3RELE9BQU8sT0FBTyxLQUFLLFFBQVEsQ0FBQyxDQUFDLENBQUMsRUFBRSxnQkFBZ0IsRUFBRSxPQUFPLEVBQUUsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFBO0lBRXZFLHFFQUFxRTtJQUNyRSxLQUFLLENBQUMsZ0JBQWdCLENBQUMsZ0JBQWdCLENBQUMsRUFBRSw0QkFBNEIsQ0FBQyxDQUFBO0lBQ3ZFLHlFQUF5RTtJQUN6RSxLQUFLLENBQ0gsb0JBQW9CLEtBQUssS0FBSyxJQUFJLG9CQUFvQixJQUFJLENBQUMsRUFDM0QscUNBQXFDLENBQ3RDLENBQUE7SUFFRCxNQUFNLGFBQWEsR0FBa0I7UUFDbkMsZ0JBQWdCO1FBQ2hCLG9CQUFvQjtLQUNyQixDQUFBO0lBQ0QsT0FBTztRQUNMLDRCQUE0QixFQUFFLGNBQWMsQ0FBQyxJQUFJLENBQy9DLEVBQUUsRUFDRjtZQUNFLGVBQWUsRUFBRSxlQUFlLENBQUMsNEJBQTRCO1lBQzdELGFBQWE7U0FDZCxDQUNGO1FBQ0QsYUFBYSxFQUFFLGNBQWMsQ0FBQyxJQUFJLENBQ2hDLEVBQUUsRUFDRjtZQUNFLGVBQWUsRUFBRSxlQUFlLENBQUMsMkJBQTJCO1lBQzVELGFBQWE7U0FDZCxDQUNGO1FBQ0QsT0FBTyxFQUFFLFFBQVEsQ0FBQyxJQUFJLENBQ3BCLEVBQUUsRUFDRjtZQUNFLGVBQWUsRUFBRSxlQUFlLENBQUMsMkJBQTJCO1lBQzVELGFBQWE7U0FDZCxDQUNGO0tBQ0YsQ0FBQTtBQUNILENBQUMifQ==